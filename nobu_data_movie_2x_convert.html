<div class="content-box mb-3 content-lighten">
    <h2><i class="fa fa-download fa-fw"></i>将星録の「AIで２倍サイズにしたムービー」をゲットする</h2>
    <p>将星録の原本ファイルを選択することで、Topaz AIで２倍化したムービーファイルがダウンロード可能です。<br>
        XVid形式でエンコードしています。<br>
        </p><p><img src="./cnt_movie/cnt_nobu_tool_movie_2x_convert_topaz_05.png"><br></p>
        <p><img src="./cnt_movie/cnt_nobu_tool_movie_2x_convert_topaz_06.png"><br></p>
    <p></p>
    <p>
        もっと近代的なH264やAV1などで圧縮したいところですが、将星録で再生させるののが<br>
        逆に難しくなりそうですので、お手頃で他のCodecへと影響しにくいXVidを選択しています<br>
    </p>
    <h4>Xvid (コーデック)</h4>
    <div class="card mb-3 ml-3" style="max-width: 30rem;">
        <!-- カード本文：card-body -->
        <div class="card-body text-center">
            <div class="row">
                <div class="col-12"><small>(ダウンロード場所)</small></div>
            </div>
            <a href="https://www.xvid.com/download/" class="btn btn-primary"><i class="fa fa-download fa-fw"></i>Xvid for Windows</a>
        </div>
    </div>

    <p>
        </p><fieldset class="alert alert-warning">
            <legend>Windowsをバージョンの大型更新をすると、Xdivの再インストールが必要</legend>
            Xdivのcodecは、Windowsを22H2⇒22H3など、大型のバージョンアップした再には、登録しているcodec情報が一部クリアされてしまいます。<br>
                これにより、Xdiv codecのムービーそのままだと、将星録が起動できなくなってしまいます。<br>
                この再には、改めて、上記codecを再インストールしてください。
        </fieldset>
    <p></p>

</div>


<div class="content-box mb-3 content-lighten">
    <h3>対象のムービーファイルを選択!</h3>
    <p>将星録本体のムービーファイルを選択してください。<br>
    該当のものが正しければ、リンクにより「２倍の解像度になったムービー」がダウンロードできます。<br>
    (無関係なものであれば、リンクもまた不正なものとなり、ダウンロードはできません)</p>
<input type="file" id="fileInput">
<p id="fileHashDisplay"></p>

<script>
    document.getElementById('fileInput').addEventListener('change', async function(event) {
        const file = event.target.files[0];

        if (file) {
            // FileReader を使用してファイルを読み込む
            const reader = new FileReader();
            reader.onload = async function(e) {
                const arrayBuffer = e.target.result;

                // crypto API を使用して SHA-256 ハッシュを計算する
                const hashBuffer = await crypto.subtle.digest('SHA-256', arrayBuffer);
                const hashArray = Array.from(new Uint8Array(hashBuffer));

                // バイト配列を16進数の文字列に変換する
                const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');

                // ハッシュ値を表示
                document.getElementById('fileHashDisplay').innerHTML = '<a href="./cnt_movie/' + hashHex + '.avi"><i class="fa fa-download fa-fw"></i>リンク</a>';
            };
            reader.readAsArrayBuffer(file);
        }
    });
</script>
</div>