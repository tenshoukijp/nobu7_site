%(hilight)s
<div class="content-box mb-3 content-lighten">
    <h2><i class="fa fa-film fa-fw"></i>将星録のムービーを綺麗に２倍にする</h2>
</div>

<div class="content-box mb-3 content-lighten">
    <h3>概要</h3>
    <ul class="pointlist">
        <li>
            <h4>現代のディスプレイの解像度に対してあまりにも小さい将星録のムービー</h4>
            <p>あまりにも小さすぎて悲しくなるサイズと言えるでしょう。</p>
        <li>
            <h4>特殊なアルゴリズムでムービーの解像度を２倍にして、状況を打開する</h4>
            <p>このページでは、画像を拡大するツールとして非常に有名な、「waifu2x-caffe」を使い、<br>
                解像度をアップコンバートすることで、 ある程度、この問題への解決を狙います。</p>
            <p>通常の「Adore PremiereやAdobe AfterEffectsなど映像ツールで解像度を２倍にする」といった一般的手法とは違い、<br>
                「高度で多計算による解像度の２倍化」となりますので、変換には相当時間がかかります。</p>
        <li>
            <h4>将星録に限定されない内容</h4>
            <p>なお、ここに記載されている内容やツールは、将星録に限定されるものではなく、<br>
                「動画の解像度を綺麗な形で２倍にする」という汎用的な目的にもかなうモノとなっています。</p>
            <p>
    </ul>
    <p>
        <fieldset class="alert alert-warning">
            <legend>Windowsをバージョンの大型更新をすると、Xdivの再インストールが必要</legend>
            Xdivのcodecは、Windowsを22H2⇒22H3など、大型のバージョンアップした再には、登録しているcodec情報が一部クリアされてしまいます。<br>
                これにより、Xdiv codecのムービーそのままだと、将星録が起動できなくなってしまいます。<br>
                この再には、改めて、上記codecを再インストールしてください。
        </fieldset>
    </p>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>TsMovie2xConverter によって ２倍化されたサンプル</h3>
    <p>(起動時のタイトルロゴや終了時のKOEIロゴと似たサイズになるので見た目が自然になる)</p>
    <p><img src="./cnt_movie/cnt_nobu_tool_movie_2x_convert_02.png"><br>
    </p>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>動作環境</h3>
    <ul class="pointlist">
        <li>
            <h4>Windows OS</h4>
            <p>Windows 7 64bit 以降が必要です。(32bitだと無理です)</p>
    </ul>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>準備その① (ムービー ⇔ 連番画像の相互変換のため)</h3>
    <ul class="pointlist">
        <li>
            <h4>ツール</h4>
            <p><b>FFmpeg/FFprobe</b> をインストールしてください。</p>
        <li>
            <h4>FFmpeg (ソフト)</h4>
            <div class="card mb-3 ml-3" style="max-width: 30rem;">
                <!-- カード本文：card-body -->
                <div class="card-body text-center">
                    <div class="row">
                        <div class="col-12"><small>(FFMpeg Windows builds by BtbN)</small></div>
                    </div>
                    <a href="https://github.com/BtbN/FFmpeg-Builds/releases" class="btn btn-primary"><i class="fa fa-download fa-fw"></i>Github BtbN FFmpeg-Builds</a>
                </div>
            </div>
            <p>まずは、該当ページからffmpegをダウンロードします。</p>
            <ul class="arrowlist">
                <li>
                    <h5>必要なファイル</h5>
                    <p>「ffmpeg-N-*****-*********-win64-gpl.zip」<br>
                        を解凍すると、実はファイルやディレクトリが沢山あります。<br>
                        しかし、必要なのファイルは「bin」フォルダの中にある<span class="positive">「ffmpeg.exe と ffprobe.exe」の２つだけ</span>です。<br>
                        <br>
                        このffmpeg.exeを適当なツールっぽいフォルダに移動し、以後これを利用するようにします。 <br>
                        <img src="./cnt_movie/cnt_nobu_tool_movie_2x_convert_01.png"><br>
                    </p>
            </ul>
            </p>
            <p>この２つを適当なフォルダにコピーしてください。<br>
                有名なコマンドアプリケーションですので、それなりのディレクトリにコピーしておくことをお勧めします。</p>
    </ul>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>準備その② (連番画像を２倍に拡大するため)</h3>
    <ul class="pointlist">
        <li>
            <h4>ツール</h4>
            <p><b>waifu2x-caffe</b></p>
            <p>をインストールしてください。</p>
            <p>インストールの詳細は、<a href="https://天翔記.jp/?page=nobu_image_expand_and_reduce">天翔記のサイトの「画像の縮小・拡大」</a>に掲載しています。</p>
            <p><span class="positive">全体で100メガを超えるファイルサイズのツールですが、サブディレクトリも含め、ディレクトリ一式必要です。</span></p>
            <p>2015年以降、急速に有名になったアプリケーションですので、<br>
                それなりのディレクトリにコピーしておくことをお勧めします。</p>
    </ul>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>TsMovie2xConverter (準備①と準備②のツールを使い、動画を２倍化するため)</h3>
    <p>将星録95(等)の動画を２倍に拡大コンバートするツールとなります。<br>
        (実際には将星録に限らず汎用目的で利用可能です)</p>
    <p>映像については、<span class="positive">waifu2x-cafeeを通して解像度を２倍化し、lib264のロスレス</span>で、<br>
        音声については、元の動画の音声そのままのデータをコピーするようなツールです。</p>
    <ul class="pointlist">
        <h4>ダウンロード</h4>

        <div class="card mb-3 ml-3" style="max-width: 30rem;">
            <!-- カード本文：card-body -->
            <div class="card-body text-center">
                <div class="row">
                    <div class="col-12"><small>更新日 %(year)04d/%(mon)02d/%(mday)02d</small></div>
                </div>
                <a href="%(file)s" class="btn btn-primary"><i class="fa fa-download fa-fw"></i>TsMovie2xConverter.zip</a>
            </div>
        </div>
        (「TsMovie2xConverter.pl」はソースファイルとなります、「TsMovie2xConverter.exe」でも「TsMovie2xConverter.pl」でも動作は同じです)
    </ul>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>TsMovie2xConverterの置き場所</h3>
    <p>TsMovie2xConverterの置き場所は好きなディレクトリに配置してもらって良いのですが、<br>
        今回は将星記のMOVIEフォルダに配置してしまいましょう。</p>
    <p><img src="./cnt_movie/cnt_nobu_tool_movie_2x_convert_03.png"><br>
    </p>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>「TsMovie2xConverter.ini」の設定</h3>
    <p>TsMovie2xConverter.iniをテキストエディタで編集してください。</p>
    <p><span class="negative">この.iniファイルが正しく編集されていないと全く動作しません!!</span><br>
    </p>
    <ul>
        <li>導入しているffmpeg.exe / ffprobe.exeへのフルパス
        <li>導入しているwaifu2x-cafee-cui.exeへのフルパス
        <li>NVIDIA製のグラボなら"gpu"、NVIDIA以外のグラボ(あるいは不明)なら"cpu"へと書き換えてください。<br>
            (cpuの場合は、変換には３倍ほど時間がかかります)
        <li><span class="negative">シングルクォーテーション「'」をダブルクォーテーション「"」に書き換えたりしないで</span>ください。<br>
            解釈が変わってエラーになります。<br>
            ディレクトリ内に空白が含まれていたとしても、ダブルクォーテーションは不要です。</li>
    </ul>
    <div class="code">
        <pre class="brush:perl;">
# ffmpegのフルパスを設定してください。
$ffmpeg  = 'C:\usr\ffmpeg\ffmpeg.exe';
$ffprobe = 'C:\usr\ffmpeg\ffprobe.exe';

# waifu2x-cafee-cuiのフルパスを設定してください。
$waifu2x = 'C:\usr\waifu2x-caffe\waifu2x-caffe-cui.exe';

# gpuが使えるのは、NVIDIA製GPUのみです。IntelやRadeonの人は &quot;cpu&quot; と書き換えてください。
$process = &quot;gpu&quot;;

# コンバートする拡張子
$extension = &quot;.avi&quot;;
    </pre>
    </div>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>ムービーを変換</h3>
    <p>「TsMovie2xConverter.exe」を実行してください。<br>
        ツールの導入や、iniの設定が正しければ、以下のように変換が始まります。</p>
    <p><img src="./cnt_movie/cnt_nobu_tool_movie_2x_convert_03.png"><br>
    </p>
</div>
<div class="content-box mb-3 content-lighten">
    <h3>数時間後…</h3>
    <p>MOVIEフォルダの<mark>「dst」というサブフォルダ</mark>に変換後の縦横２倍になった大きなムービーが出来上がります。<br>
    </p>
    <p>この出来上がった大きなサイズのムービーを、<mark>元の小さなムービーに上書き</mark>すれば完成です。</p>
</div>